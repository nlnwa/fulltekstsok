apiVersion: batch/v1
kind: Job
metadata:
  name: process-nlwa-html-heritrix-01
spec:
  template:
    metadata:
      labels:
        app: process-nlwa-html-heritrix
    spec:
      restartPolicy: Never
      containers:
      - name: main-01
        image: registry.nb.no:5000/sprakbanken/nlwa_index_html:heritrix_ordered_paths7
        command: ["python3", "process-warc-html.py", "jobs/x-01.csv"]
        env:
          - name: POSTGRES_USER
            value: "admin"
          - name: POSTGRES_DB
            value: "nlwa_index_heritrix"
          - name: POSTGRES_PASSWORD
            valueFrom:
              secretKeyRef:
                name: sprakbank-postgres-secret
                key: POSTGRES_PASSWORD
          - name: POSTGRES_HOST
            value: "sprakbank-postgres"
          - name: POSTGRES_PORT
            value: "5432"
        volumeMounts:
          - name: sprakbank-fs01
            mountPath: /mnt/data
      volumes:
        - name: sprakbank-fs01
          persistentVolumeClaim:
            claimName: sprakbank-fs01-ro-pvc
