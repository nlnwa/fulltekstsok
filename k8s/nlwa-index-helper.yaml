apiVersion: v1
kind: Pod
metadata:
  name: nlwa-index-helper
spec:
  containers:
    - name: nlwa-index-helper
      image: registry.nb.no:5000/sprakbanken/nlwa_index_helper:3
      envFrom:
        - configMapRef:
              name: sprakbank-postgres-config
      env:
        - name: POSTGRES_PASSWORD
          valueFrom:
            secretKeyRef:
              name: sprakbank-postgres-secret
              key: POSTGRES_PASSWORD
        - name: POSTGRES_HOST
          value: "sprakbank-postgres"
        - name: POSTGRES_PORT
          value: "5432"
      command: [ "/bin/sh" ]
      args: [ "-c", "sleep infinity"]
      volumeMounts:
        - name: sprakbank-fs00
          mountPath: /mnt/data
  nodeSelector:
    kubernetes.io/hostname: nbd1k8s7.lx.nb.no
  tolerations:
    - key: "node.kubernetes.io/unschedulable"
      operator: "Exists"
      effect: "NoSchedule"
  volumes:
    - name: sprakbank-fs00
      persistentVolumeClaim:
        claimName: sprakbank-fs00-ro-pvc
